<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>JStream</title>
    <!-- Content Security Policy: For development, Vite/Electron requires 'unsafe-eval'. Remove or tighten this before production builds. -->
    <!-- Added firebase remote-config and YouTube origins so renderer can fetch remote config and embed YouTube players. Only add trusted sources. -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; connect-src 'self' http://localhost:5173 http://localhost:5174 http://localhost:5175 https://api.themoviedb.org https://player.videasy.net https://firebaseremoteconfig.googleapis.com; frame-src 'self' https://player.videasy.net https://www.youtube.com https://www.youtube-nocookie.com; child-src 'self' https://player.videasy.net;">

    <!-- Ensure document.head exists for Vite HMR -->
    <script>
      // Very early safety: ensure there is a head element and provide a
      // defensive appendChild for style nodes so Vite's HMR won't throw
      // if it runs before the page is fully constructed.
      (function(){
        try {
          if (!document.head) {
            var _h = document.createElement('head');
            document.documentElement.insertBefore(_h, document.documentElement.firstChild || null);
          }

          // Patch insertBefore for Element to tolerate failures and fallback
          var realInsertBefore = Element.prototype.insertBefore;
          Element.prototype.insertBefore = function(newNode, referenceNode) {
            try {
              return realInsertBefore.call(this, newNode, referenceNode);
            } catch (e) {
              try {
                // fallback: append to document.documentElement
                return document.documentElement.appendChild(newNode);
              } catch (err) {
                return null;
              }
            }
          };
        } catch (e) {
          // ignore any failures here â€” this is only defensive
        }
      })();
    </script>
  </head>
  <body>
    <!-- top-level portal target for full-bleed hero so it can live outside centered app shell -->
    <div id="hero-root"></div>
    <!-- portal target for the sticky header so it isn't constrained by #root layout -->
    <div id="header-root"></div>
    <div id="root"></div>
    <script type="module" src="/src/renderer.tsx"></script>
  </body>
</html>
